image: alpine/edge
secrets:
  - e543f154-cfa9-4b56-b8aa-adbd8ec0adf7
packages:
  - aws-cli
  - hugo
environment:
  REPO: michaelkelly.org
  PUSH_BRANCH: master
tasks:
  - check-branch: |
      cd ~/"${REPO}"
      if [ "x$(git rev-parse origin/${PUSH_BRANCH} --)" != "x$(git rev-parse HEAD --)" ]; then
          complete-build
      fi
  - deploy: |
      cd ~/"${REPO}"
      ./scripts/deploy.sh
